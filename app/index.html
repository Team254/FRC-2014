<!-- written by: Ryan Johnson, Art Kalb, Maxwell Yun -->
<!DOCTYPE HTML>
<html>
<head>
  <script src="jquery.min.js"></script>
  <script src="rainbow.js" ></script>
<script type="text/javascript">
 var dataarray = {
				Motor_Speed: {
					Left: 15,
					Right: 12
				},
				Encoders: {
					LF: 15,
					RF: 7,
					LB: 8,
					RB: 10
				},
				Test: {
					LF: 15,
					RF: 7,
					LB: 8,
					RB: 10
				},
				gyro: 25
 }
  var scs = {
};
var containers = [];
	function findTabSubset(tabName){
		var subset = [];
		for(v in scs){
			if(scs[v].tab == tabName)
				subset.push(v);
		}
		return subset;
	}
   $(document).ready(function(e) {
	   /*var which = "Drivebase"
	   scs[which].data.push({y: 25});
	   alert(scs[which].data[2].y);*/
    CanvasJS.addColorSet("Blue",
                [//colorSet Array
                "#0070FF",             
                ]);
	CanvasJS.addColorSet("Green",
                [//colorSet Array
                "#00AA00",             
                ]);
	CanvasJS.addColorSet("Red",
                [//colorSet Array
                "#FF0000",             
                ]);
	CanvasJS.addColorSet("Dark",
                [//colorSet Array
                "#222222",             
                ]);
	CanvasJS.addColorSet("Light",
                [//colorSet Array
                "#DDDDDD",             
                ]);
	CanvasJS.addColorSet("Multi",
                [//colorSet Array
                "#FF0000",
				"#00AA00", 
				"#0070FF", 
				"#986CF8", 
				"#F28263",
				"#222222",           
                ]);
	genall();
	});
  	  
	  function add(value, handler, plot){
		  var data = parseInt(value.Drivebase[0].y);
		  scs[handler].data[plot].push(
		  {y: data}
		  );
	  }
	  //use parsejson before add.
	  function graphlist(){
		var subset = [];
		for(v in scs){
				subset.push(v);
		}
		return subset;
	  }
	  
	  function randoms(handler){
		  getdata(handler);
		  generate(handler);
	  }
	var current = "Drivebase";
	var last = "Drivebase";
      
	  function parsejson(arrayin){
		if (current != last){
			scs = {};
			containers = [];
			$("#content").html() = "";
		}
		for (var key in arrayin){
			if (scs[key] === undefined){
				$("#content").append('<div id="' + key + '" style="height: 300px; width: 100%;">asd</div>');
				scs[key] = [];
				containers.push(key);
			}
			if (scs[key].data === undefined){
				scs[key].data = [];
			}
			if (typeof(arrayin[key]) == "object"){
				var i = 0;
				for (var subkey in arrayin[key]){
					if (scs[key].data[i] === undefined){
						scs[key].data[i]=[];
					}
					if (scs[key].data[i][0] === undefined){
						scs[key].data[i][0]=subkey;
					}
					scs[key].data[i].push({y: arrayin[key][subkey]});
					i = i + 1;
				}
			} else {
				scs[key].data.push({y: arrayin[key]});
			}
			scs[key].assocvar = "";
		}
		last = current;
	}
	  function getdata(handler){
		  $.getJSON('json.php',function(datajson) {
			  parsejson(datajson);
			  generate(handler);
			  
		  });
	  }
	  function ggd(handler){
		//generate graph data
		var indata = [];
			if (scs[handler].data[0][0] != undefined){
				console.log("multi");
				for (i = 0; i < scs[handler].data.length; i++){
					data = [];
					for (j = 1; j < scs[handler].data[i].length; j ++){
						data.push(scs[handler].data[i][j]);
					}
					indata.push({type: "line", showInLegend: true, lineThickness: 2, name: scs[handler].data[i][0], dataPoints: data});
				}
			} else {
				console.log("single");
				indata.push({type: "line", showInLegend: true, lineThickness: 2, name: handler, dataPoints: scs[handler].data});
			}
		
		return indata;   
	}
      function generate (handler) {
          scs[handler].assocvar = new CanvasJS.Chart(handler, {
              theme: "theme1",//theme1
              
			  colorSet: "Multi",
			  
			  title:{
                  text: handler             
              },
              data: ggd(handler)             
              /*{
                  type: "line",
                  dataPoints: scs[handler].data[0]
				  
              },
			  {
                  type: "line",
                  dataPoints: scs[handler].data[1]
				  
              },*/
          });
          scs[handler].assocvar.render();
      }
	   function genall(){
			for (i in scs){
				console.log(i);
				generate(i);
				
			}
			
		   /*generate("Intake");
		   generate("Drivebase");
		   generate("Shooter");
		   generate("Arm");
		   */
	   }
	   function getall(){
		   $.getJSON('json.php',function(datajson) {
			  
			  parsejson(dataarray);
			  genall();
		  });
	   }
	  setInterval(function(){
		  getall();
		  }, 1000);
  </script>
  <!--<script type="text/javascript" src="http://canvasjs.com/assets/script/canvasjs.min.js"></script>-->
  <script type="text/javascript" src="canvasjs-1/canvasjs.min.js"></script>
<link href="css.css" rel="stylesheet" type="text/css">
</head>
<body>
<nav>
Teh Chezy Pofs Deta Lawgr
</nav>
<div id="content">
<!--<div id="usual1" class="usual" style="border:none"> 
  <div class="ulcontain">
  <ul> 
    <li><a name="tab1" href="#tab1" class="selected">Drivebase</a></li> 
    <li><a name="tab2" href="#tab2">Intake</a></li> 
    <li><a name="tab3" href="#tab3">Shooter</a></li> 
  </ul> 
  </div>
  <div class="usual" id="tab1">
      <div id="chartContainera" style="height: 300px; width: 100%;"></div><br>
      <div id="chartContainerab" style="height: 300px; width: 100%;"></div>
  </div> 
  <div class="usual" id="tab2"><div id="chartContainerb" style="height: 300px; width: 100%;"></div></div> 
  <div class="usual" id="tab3"><div id="chartContainerc" style="height: 300px; width: 100%;"></div></div> --> 
</div>
<script src="tabbed.js"></script>
<script type="text/javascript"> 
  $("#usual1 ul").idTabs(); 
</script>
<script>
	var currentTab = "tab1";
  /*$('h1').rainbow({ 
    colors: [
        '#FF0000',
        '#f26522',
        '#fff200',
        '#00a651',
        '#28abe2',
        '#2e3192',
        '#6868ff'
    ],
    animate: true,
    animateInterval: 100,
    pad: false,
    pauseLength: 100,
});*/
	$( ".usual a" ).bind( "click", function() {
		var subset = findTabSubset($(this).attr("name"));
	  	for(var v in subset){
			generate(subset[v]);
		}
		currentTab = $(this).attr("name");
	});
  </script>
  <div id="extra"></div>
</body>
</html>